---
# Crawler Seeds ConfigMap (migrated from yacy-seeds)
apiVersion: v1
kind: ConfigMap
metadata:
  name: crawler-seeds
  namespace: digest
data:
  seeds.txt: |
    # News agencies
    https://reuters.com
    https://apnews.com
    https://bbc.com
    https://aljazeera.com
    https://dw.com

    # Science
    https://nature.com
    https://sciencemag.org
    https://arxiv.org
    https://mit.edu
    https://wired.com

    # Ukraine
    https://pravda.com.ua
    https://suspilne.media
    https://unian.net
    https://ukrinform.net

    # Russia (independent)
    https://meduza.io
    https://theins.ru
    https://novayagazeta.eu

    # International organizations
    https://who.int
    https://un.org
    https://europa.eu

    # Cyprus news
    https://cyprus-mail.com
    https://philenews.com
    https://sigmalive.com
    https://reporter.com.cy
    https://politis.com.cy
    https://alphanews.live
    https://cyprusnews.eu
    https://pafospress.com
    https://cosmosnews.com.cy
    https://pafosnet.com
    https://newsincyprus.com
---
# Crawler Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: news-crawler
  namespace: digest
spec:
  replicas: 2
  selector:
    matchLabels:
      app: news-crawler
  template:
    metadata:
      labels:
        app: news-crawler
    spec:
      containers:
      - name: crawler
        image: ghcr.io/lueurxax/telegram-digest-bot/crawler:latest
        imagePullPolicy: Always
        env:
        - name: SOLR_URL
          value: "http://solr:8983/solr/news"
        - name: SOLR_TIMEOUT
          value: "10s"
        - name: CRAWL_DEPTH
          value: "2"
        - name: CRAWL_RATE_LIMIT_RPS
          value: "2"
        - name: CRAWL_BATCH_SIZE
          value: "10"
        - name: CRAWL_CLAIM_TTL
          value: "5m"
        - name: CRAWL_USER_AGENT
          value: "TelegramDigestBot/1.0 (+https://github.com/lueurxax/telegram-digest-bot)"
        - name: CRAWL_SEEDS_FILE
          value: "/config/seeds.txt"
        - name: HEALTH_PORT
          value: "8080"
        - name: LOG_LEVEL
          value: "info"
        ports:
        - containerPort: 8080
          name: health
        volumeMounts:
        - name: seeds
          mountPath: /config
        resources:
          requests:
            memory: "256Mi"
            cpu: "100m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 20
        readinessProbe:
          httpGet:
            path: /readyz
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 10
      volumes:
      - name: seeds
        configMap:
          name: crawler-seeds
