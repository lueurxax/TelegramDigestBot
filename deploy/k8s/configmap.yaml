apiVersion: v1
kind: ConfigMap
metadata:
  name: digest-config
  namespace: digest
data:
  APP_ENV: "prod"
  # Digest settings
  DIGEST_WINDOW: "60m"
  DIGEST_TOP_N: "20"
  RELEVANCE_THRESHOLD: "0.5"
  IMPORTANCE_THRESHOLD: "0.3"
  SIMILARITY_THRESHOLD: "0.5"
  AUTO_THRESHOLD_TUNING_ENABLED: "true"
  # Health & monitoring
  HEALTH_PORT: "8080"
  # Leader election
  LEADER_ELECTION_ENABLED: "true"
  LEADER_ELECTION_LEASE_NAME: "digest-scheduler-lease"
  # Telegram session
  TG_SESSION_PATH: "/app/data/tg.session"
  # LLM settings
  LLM_MODEL: "gpt-5-nano"
  # Worker settings
  WORKER_BATCH_SIZE: "10"
  WORKER_POLL_INTERVAL: "10s"
  # Reader settings
  READER_FETCH_LIMIT: "20"
  RATE_LIMIT_RPS: "10"
  # Scheduler settings
  SCHEDULER_TICK_INTERVAL: "10m"
  SCHEDULER_CATCHUP_WINDOW: "24h"
  FACTCHECK_GOOGLE_ENABLED: "true"
  # Enrichment settings (Phase 2)
  ENRICHMENT_ENABLED: "true"
  ENRICHMENT_MAX_RESULTS: "5"
  ENRICHMENT_MAX_SECONDS: "1200"
  ENRICHMENT_CACHE_TTL_HOURS: "168"
  ENRICHMENT_QUEUE_MAX: "5000"
  ENRICHMENT_MIN_AGREEMENT: "0.10"
  ENRICHMENT_MAX_EVIDENCE_PER_ITEM: "5"
  ENRICHMENT_DEDUP_SIMILARITY: "0.98"
  ENRICHMENT_ALLOWLIST_DOMAINS: ""
  ENRICHMENT_DENYLIST_DOMAINS: "didaktorika.gr,arxiv.org"
  ENRICHMENT_QUERY_TRANSLATE: "true"
  ENRICHMENT_PROVIDERS: "solr,yacy,gdelt,newsapi,searxng"
  ENRICHMENT_PROVIDER_COOLDOWN: "10m"
  ENRICHMENT_PROVIDER_GRACE: "3s"
  # Solr provider (SolrCloud)
  SOLR_ENABLED: "true"
  SOLR_URL: "http://solr:8983/solr/news"
  SOLR_TIMEOUT: "10s"
  SOLR_MAX_RESULTS: "10"
  # YaCy provider (legacy - can be disabled once Solr is stable)
  ENRICHMENT_YACY_ENABLED: "true"
  ENRICHMENT_YACY_URL: "http://yacy:8090"
  ENRICHMENT_YACY_TIMEOUT: "10s"
  ENRICHMENT_YACY_MAX_RESULTS: "10"
  ENRICHMENT_DAILY_BUDGET_USD: "100"
  ENRICHMENT_MONTHLY_CAP_USD: "2000"
  # OpenSearch provider (disabled by default - requires pre-populated index)
  ENRICHMENT_OPENSEARCH_ENABLED: "false"
  ENRICHMENT_OPENSEARCH_URL: ""
  ENRICHMENT_OPENSEARCH_INDEX: "news"
  ENRICHMENT_OPENSEARCH_RPM: "60"
  ENRICHMENT_OPENSEARCH_TIMEOUT: "30s"
  # Event Registry provider
  ENRICHMENT_EVENTREGISTRY_ENABLED: "false"
  ENRICHMENT_EVENTREGISTRY_TIMEOUT: "30s"
  # NewsAPI provider
  ENRICHMENT_NEWSAPI_ENABLED: "true"
  ENRICHMENT_NEWSAPI_TIMEOUT: "30s"
  SEARXNG_ENABLED: "true"
  SEARXNG_BASE_URL: "http://searxng:8080"
  SEARXNG_TIMEOUT: "30s"
  SEARXNG_ENGINES: "brave,qwant,wikipedia,arxiv,crossref"
  GDELT_ENABLED: "true"
  GDELT_RPM: "30"
  GDELT_TIMEOUT: "30s"
  # Evidence-enhanced clustering
  EVIDENCE_CLUSTERING_ENABLED: "true"
  EVIDENCE_CLUSTERING_BOOST: "0.15"
  EVIDENCE_CLUSTERING_MIN_SCORE: "0.25"
  LINK_ENRICHMENT_ENABLED: "true"
  LINK_ENRICHMENT_SCOPE: "summary, relevance, topic, dedup, queries, factcheck"
  ENRICHMENT_LANGUAGE_POLICY: '{
  "default": [ "en" ],
  "context": [ { "name": "cyprus","languages": [ "el" ],"keywords": [ "cyprus","nicosia","limassol","larnaca","paphos" ] } ],
  "channel": { "@russiancyprusnews": [ "el" ] }
}'
  ENRICHMENT_QUERY_LLM: "true"
  ENRICHMENT_LLM_TIMEOUT: "120s"
